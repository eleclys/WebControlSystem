# 焦炉温度控制模型

## 系统特性

分别记加热装置特性为$D_1(z)$，焦炉本体特性$D_2(z)$。基于典型工业模型，建立数学表达式如下：

| 模块     | 建模形式       | 物理特性                           | 原因                     |
| -------- | -------------- | ---------------------------------- | ------------------------ |
| 控制器   | Smith预估      | 对抗系统时滞                       | 适合焦炉控制（因时滞大） |
| 加热装置 | 一阶差分带时延 | 加热响应惯性 + 滞后                | 通常为一阶系统           |
| 焦炉本体 | 二阶差分带时延 | 热惯性 + 炉墙热传导 + 气体传热延迟 | 贴近焦炉动态             |

### 加热装置的特性 $D_1(z)$

加热装置通常表现为一阶滞后系统，具有一定的纯滞后时间。其离散时间传递函数可表示为：
$$
D_1(z) = \frac{K_1 \cdot z^{-d_1}}{1 - a_1 \cdot z^{-1}}
$$
其中：

$K_1$是系统增益，代表加热装置对输入功率变化的响应程度。

$a_1$是系统的极点，决定系统的响应速度。体现加热装置的动态惯性（记忆性）。

$d_1$是纯滞后时间，表示系统响应的延迟。

此模型适用于描述燃烧器或电加热元件的热惯性特性。

时域差分方程形式：$h(k)=a_1h(k-1)+K_1u(k-d_1)$



### 焦炉本体的特性 $D_2(z)$

焦炉本体的热传递过程更为复杂，通常被建模为二阶系统，以捕捉其热惯性和分布特性。其离散时间传递函数可表示为：
$$
D_2(z) = \frac{K_2 \cdot z^{-d_2}}{(1 - a_2 \cdot z^{-1})(1 - a_3 \cdot z^{-1})}
$$
其中，

$K_2$ 是系统增益，代表焦炉对热输入的响应程度。

$a_2$ 和 $a_3$ 是系统的极点，决定系统的动态响应特性。

$d_2$ 是纯滞后时间，表示系统响应的延迟。

该模型考虑了焦炉内的热传导、对流和辐射等多种热传递机制，适用于描述焦炉炭化室的热动态行为。从特性上来看，该表达式显式包含纯滞后、隐式包含容量滞后（二阶系统），符合实际情况。

时域差分方程形式：$T(k)=(a_2 + a_3)T(k-1)-(a_2a_3)T(k-2)+K_2h(k-d_2)$



### 参数辨识与模型应用

1. **系统辨识**：通过阶跃响应实验或最小二乘法等系统辨识技术，确定上述模型中的参数 $K_1$,$a_1$,$d_1$;$K_2$,$a_2$,$a_3$,$d_2$
2. **控制器设计**：基于辨识得到的模型参数，设计相应的数字控制器
3. **模型验证**

参数取值可查阅相关文献，这里列出一些参考值：

| 参数         | 说明                             | 典型取值范围 | 数据来源/备注                              |
| ------------ | -------------------------------- | ------------ | ------------------------------------------ |
| $a_1$        | 加热装置动态惯性系数             | 0.7 ~ 0.95   | 参考工业炉加热器动态响应，一阶滞后时间较短 |
| $K_1$        | 加热装置增益                     | 0.5 ~ 1.5    | 取决于加热器功率和控制信号量纲             |
| $d_1$        | 加热装置输入滞后（采样周期单位） | 1 ~ 10步     | 通常几秒至十几秒的控制信号响应延迟         |
| $a_2$, $a_3$ | 焦炉温度模型特征根相关参数       | 0.3 ~ 0.8    | 满足系统稳定性，二阶系统阻尼和惯性         |
| $K_2$        | 焦炉温度对加热量的增益           | 0.1 ~ 0.5    | 热容量大，响应幅度较缓慢                   |
| $d_2$        | 焦炉热传递滞后（采样周期单位）   | 5 ~ 20步     | 反映热传导及炉膛热惯性的滞后，通常较长     |

注意：上述“步数”代表的滞后时间=采样周期乘以步数。这个温度控制系统采样周期通常在10到30秒，若采样周期为10秒，则`d1 = 2`表示20秒延迟。

不妨设以下取值：

取采样周期10s，

| 参数  | 数值     | 说明                          |
| ----- | -------- | ----------------------------- |
| $a_1$ | 0.78     | 加热器一阶惯性系数            |
| $K_1$ | 1.23     | 加热器增益                    |
| $d_1$ | 10（步） | 加热器时滞（相当约100 s）     |
| $a_2$ | 0.9835   | 炉体第一根特征根              |
| $a_3$ | 0.9917   | 炉体第二根特征根              |
| $K_2$ | 0.5      | 炉体对热流的增益              |
| $d_2$ | 20（步） | 炉体热传递时滞（相当约200 s） |



## 控制器设计

这个系统控制的难点在于双重时滞$d_1$、$d_2$。

根据上述模型参考值，有

加热装置：$h(k)=0.78h(k-1)+1.23u(k-10)$

焦炉本体：$T(k)=1.9752T(k-1)-0.97533695T(k-2)+0.5h(k-20)$

不妨采用传统的数字PID控制器看看效果。根据$u(k)$、$u(k-1)$可得到差分形式下的累积位置式：
$$
u(k)=u(k-1)+K_p[e(k)-e(k-1)]+K_ie(k)+K_d[e(k)-2e(k-1)+e(k-2)]
$$
这个形式与标准的位置式PID数学上是等价的，但是控制效果不同。

| 比较           | 差分位置式 PID     | 标准位置式 PID     |
| -------------- | ------------------ | ------------------ |
| 实际实现       | 稳定、抗抖、易实现 | 直观、调参直接     |
| 抗干扰性       | 高（需滤波）       | 好（积分抗扰）     |
| 控制平滑性     | 优（步进控制）     | 易跳跃（直接输出） |
| 初始误差敏感性 | 高                 | 低                 |

